---
description: Run DataSync Task
schemaVersion: "0.3"

parameters:
  Cluster:
    type: String
    description: "ECS cluster to update"

  Service:
    type: String
    description: "ECS service to update"

mainSteps:
  - name: replaceEcsTask
    action: aws:executeScript
    inputs:
      Runtime: python3.8
      Handler: handler
      InputPayload:
        cluster: "{{ Cluster }}"
        service: "{{ Service }}"
      Script: |-
        def handler(events,context):
          import boto3
          ecs = boto3.client('ecs')

          cluster = events['cluster']
          service = events['service']

          ecs.update_service(
              cluster=cluster,
              service=service,
              forceNewDeployment=True
          )
    isEnd: true
